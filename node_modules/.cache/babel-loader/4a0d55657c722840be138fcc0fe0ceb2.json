{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar react_1 = require(\"react\");\n\nvar fast_deep_equal_1 = tslib_1.__importDefault(require(\"fast-deep-equal\"));\n\nvar utilities_1 = require(\"../../utilities\");\n\nvar reducer_1 = require(\"./reducer\");\n\nvar useHandlers_1 = require(\"./hooks/useHandlers\");\n\nfunction useDynamicList(listOrConfig, fieldFactory, validationDependencies) {\n  if (validationDependencies === void 0) {\n    validationDependencies = [];\n  }\n\n  var calculatedList = Array.isArray(listOrConfig) ? listOrConfig : listOrConfig.list;\n  var validates = Array.isArray(listOrConfig) ? {} : listOrConfig.validates || {}; // const [calculatedList] = useState<Item[]>(initialList);\n\n  var _a = tslib_1.__read(reducer_1.useListReducer(calculatedList), 2),\n      state = _a[0],\n      dispatch = _a[1];\n\n  react_1.useEffect(function () {\n    if (!fast_deep_equal_1.default(calculatedList, state.initial)) {\n      dispatch(reducer_1.reinitializeAction(calculatedList));\n    }\n  }, [calculatedList, state.initial, dispatch]);\n  var validationConfigs = react_1.useMemo(function () {\n    return utilities_1.mapObject(validates, utilities_1.normalizeValidation);\n  }, tslib_1.__spread([validates], validationDependencies));\n\n  function addField() {\n    dispatch(reducer_1.addFieldsAction([fieldFactory()]));\n  }\n\n  function removeField(index) {\n    dispatch(reducer_1.removeFieldsAction(index));\n  }\n\n  var handlers = useHandlers_1.useHandlers(state, dispatch, validationConfigs);\n  var fields = react_1.useMemo(function () {\n    return state.list.map(function (item, index) {\n      return utilities_1.mapObject(item, function (field, key) {\n        return tslib_1.__assign(tslib_1.__assign({}, field), handlers[index][key]);\n      });\n    });\n  }, [state.list, handlers]);\n  return {\n    fields: fields,\n    addField: addField,\n    removeField: removeField\n  };\n}\n\nexports.useDynamicList = useDynamicList;","map":{"version":3,"sources":["/Users/timi/Desktop/typescript-test/node_modules/@shopify/react-form/dist/src/hooks/list/dynamiclist.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","react_1","fast_deep_equal_1","__importDefault","utilities_1","reducer_1","useHandlers_1","useDynamicList","listOrConfig","fieldFactory","validationDependencies","calculatedList","Array","isArray","list","validates","_a","__read","useListReducer","state","dispatch","useEffect","default","initial","reinitializeAction","validationConfigs","useMemo","mapObject","normalizeValidation","__spread","addField","addFieldsAction","removeField","index","removeFieldsAction","handlers","useHandlers","fields","map","item","field","key","__assign"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar react_1 = require(\"react\");\nvar fast_deep_equal_1 = tslib_1.__importDefault(require(\"fast-deep-equal\"));\nvar utilities_1 = require(\"../../utilities\");\nvar reducer_1 = require(\"./reducer\");\nvar useHandlers_1 = require(\"./hooks/useHandlers\");\nfunction useDynamicList(listOrConfig, fieldFactory, validationDependencies) {\n    if (validationDependencies === void 0) { validationDependencies = []; }\n    var calculatedList = Array.isArray(listOrConfig)\n        ? listOrConfig\n        : listOrConfig.list;\n    var validates = Array.isArray(listOrConfig)\n        ? {}\n        : listOrConfig.validates || {};\n    // const [calculatedList] = useState<Item[]>(initialList);\n    var _a = tslib_1.__read(reducer_1.useListReducer(calculatedList), 2), state = _a[0], dispatch = _a[1];\n    react_1.useEffect(function () {\n        if (!fast_deep_equal_1.default(calculatedList, state.initial)) {\n            dispatch(reducer_1.reinitializeAction(calculatedList));\n        }\n    }, [calculatedList, state.initial, dispatch]);\n    var validationConfigs = react_1.useMemo(function () {\n        return utilities_1.mapObject(validates, utilities_1.normalizeValidation);\n    }, tslib_1.__spread([validates], validationDependencies));\n    function addField() {\n        dispatch(reducer_1.addFieldsAction([fieldFactory()]));\n    }\n    function removeField(index) {\n        dispatch(reducer_1.removeFieldsAction(index));\n    }\n    var handlers = useHandlers_1.useHandlers(state, dispatch, validationConfigs);\n    var fields = react_1.useMemo(function () {\n        return state.list.map(function (item, index) {\n            return utilities_1.mapObject(item, function (field, key) {\n                return tslib_1.__assign(tslib_1.__assign({}, field), handlers[index][key]);\n            });\n        });\n    }, [state.list, handlers]);\n    return { fields: fields, addField: addField, removeField: removeField };\n}\nexports.useDynamicList = useDynamicList;\n"]},"metadata":{},"sourceType":"script"}