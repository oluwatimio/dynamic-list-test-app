{"ast":null,"code":"import { objectWithoutProperties as _objectWithoutProperties } from '../../_virtual/_rollupPluginBabelHelpers.js';\nimport React$1, { useState, useRef, useCallback, useEffect, Children } from 'react';\nimport { useUniqueId } from '../../utilities/unique-id/hooks.js';\nimport { portal } from '../shared.js';\nimport { findFirstFocusableNodeIncludingDisabled, focusNextFocusableNode } from '../../utilities/focus.js';\nimport { Portal as Portal$1 } from '../Portal/Portal.js';\nimport { Section as Section$1 } from './components/Section/Section.js';\nimport { Pane as Pane$1 } from './components/Pane/Pane.js';\nimport { PopoverOverlay as PopoverOverlay$1, PopoverCloseSource } from './components/PopoverOverlay/PopoverOverlay.js';\nexport { PopoverCloseSource } from './components/PopoverOverlay/PopoverOverlay.js';\nimport { setActivatorAttributes as setActivatorAttributes$1 } from './set-activator-attributes.js'; // TypeScript can't generate types that correctly infer the typing of\n// subcomponents so explicitly state the subcomponents in the type definition.\n// Letting this be implicit works in this project but fails in projects that use\n// generated *.d.ts files.\n\nconst Popover = function Popover(_ref) {\n  let {\n    activatorWrapper = 'div',\n    children,\n    onClose,\n    activator,\n    active,\n    fixed,\n    ariaHaspopup,\n    preferInputActivator = true,\n    colorScheme\n  } = _ref,\n      rest = _objectWithoutProperties(_ref, [\"activatorWrapper\", \"children\", \"onClose\", \"activator\", \"active\", \"fixed\", \"ariaHaspopup\", \"preferInputActivator\", \"colorScheme\"]);\n\n  const [activatorNode, setActivatorNode] = useState();\n  const activatorContainer = useRef(null);\n  const WrapperComponent = activatorWrapper;\n  const id = useUniqueId('popover');\n  const setAccessibilityAttributes = useCallback(() => {\n    if (activatorContainer.current == null) {\n      return;\n    }\n\n    const firstFocusable = findFirstFocusableNodeIncludingDisabled(activatorContainer.current);\n    const focusableActivator = firstFocusable || activatorContainer.current;\n    const activatorDisabled = 'disabled' in focusableActivator && Boolean(focusableActivator.disabled);\n    setActivatorAttributes$1(focusableActivator, {\n      id,\n      active,\n      ariaHaspopup,\n      activatorDisabled\n    });\n  }, [id, active, ariaHaspopup]);\n\n  const handleClose = source => {\n    onClose(source);\n\n    if (activatorContainer.current == null) {\n      return;\n    }\n\n    if ((source === PopoverCloseSource.FocusOut || source === PopoverCloseSource.EscapeKeypress) && activatorNode) {\n      const focusableActivator = findFirstFocusableNodeIncludingDisabled(activatorNode) || findFirstFocusableNodeIncludingDisabled(activatorContainer.current) || activatorContainer.current;\n\n      if (!focusNextFocusableNode(focusableActivator, isInPortal)) {\n        focusableActivator.focus();\n      }\n    }\n  };\n\n  useEffect(() => {\n    if (!activatorNode && activatorContainer.current) {\n      setActivatorNode(activatorContainer.current.firstElementChild);\n    } else if (activatorNode && activatorContainer.current && !activatorContainer.current.contains(activatorNode)) {\n      setActivatorNode(activatorContainer.current.firstElementChild);\n    }\n\n    setAccessibilityAttributes();\n  }, [activatorNode, setAccessibilityAttributes]);\n  useEffect(() => {\n    if (activatorNode && activatorContainer.current) {\n      setActivatorNode(activatorContainer.current.firstElementChild);\n    }\n\n    setAccessibilityAttributes();\n  }, [activatorNode, setAccessibilityAttributes]);\n  const portal = activatorNode ? /*#__PURE__*/React$1.createElement(Portal$1, {\n    idPrefix: \"popover\"\n  }, /*#__PURE__*/React$1.createElement(PopoverOverlay$1, Object.assign({\n    id: id,\n    activator: activatorNode,\n    preferInputActivator: preferInputActivator,\n    onClose: handleClose,\n    active: active,\n    fixed: fixed,\n    colorScheme: colorScheme\n  }, rest), children)) : null;\n  return /*#__PURE__*/React$1.createElement(WrapperComponent, {\n    ref: activatorContainer\n  }, Children.only(activator), portal);\n};\n\nfunction isInPortal(element) {\n  let parentElement = element.parentElement;\n\n  while (parentElement) {\n    if (parentElement.matches(portal.selector)) return false;\n    parentElement = parentElement.parentElement;\n  }\n\n  return true;\n}\n\nPopover.Pane = Pane$1;\nPopover.Section = Section$1;\nexport { Popover };","map":{"version":3,"sources":["/Users/timi/Desktop/typescript-test/node_modules/@shopify/polaris/dist/esm/components/Popover/Popover.js"],"names":["objectWithoutProperties","_objectWithoutProperties","React$1","useState","useRef","useCallback","useEffect","Children","useUniqueId","portal","findFirstFocusableNodeIncludingDisabled","focusNextFocusableNode","Portal","Portal$1","Section","Section$1","Pane","Pane$1","PopoverOverlay","PopoverOverlay$1","PopoverCloseSource","setActivatorAttributes","setActivatorAttributes$1","Popover","_ref","activatorWrapper","children","onClose","activator","active","fixed","ariaHaspopup","preferInputActivator","colorScheme","rest","activatorNode","setActivatorNode","activatorContainer","WrapperComponent","id","setAccessibilityAttributes","current","firstFocusable","focusableActivator","activatorDisabled","Boolean","disabled","handleClose","source","FocusOut","EscapeKeypress","isInPortal","focus","firstElementChild","contains","createElement","idPrefix","Object","assign","ref","only","element","parentElement","matches","selector"],"mappings":"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","sourcesContent":["import { objectWithoutProperties as _objectWithoutProperties } from '../../_virtual/_rollupPluginBabelHelpers.js';\nimport React$1, { useState, useRef, useCallback, useEffect, Children } from 'react';\nimport { useUniqueId } from '../../utilities/unique-id/hooks.js';\nimport { portal } from '../shared.js';\nimport { findFirstFocusableNodeIncludingDisabled, focusNextFocusableNode } from '../../utilities/focus.js';\nimport { Portal as Portal$1 } from '../Portal/Portal.js';\nimport { Section as Section$1 } from './components/Section/Section.js';\nimport { Pane as Pane$1 } from './components/Pane/Pane.js';\nimport { PopoverOverlay as PopoverOverlay$1, PopoverCloseSource } from './components/PopoverOverlay/PopoverOverlay.js';\nexport { PopoverCloseSource } from './components/PopoverOverlay/PopoverOverlay.js';\nimport { setActivatorAttributes as setActivatorAttributes$1 } from './set-activator-attributes.js';\n\n// TypeScript can't generate types that correctly infer the typing of\n// subcomponents so explicitly state the subcomponents in the type definition.\n// Letting this be implicit works in this project but fails in projects that use\n// generated *.d.ts files.\nconst Popover = function Popover(_ref) {\n  let {\n    activatorWrapper = 'div',\n    children,\n    onClose,\n    activator,\n    active,\n    fixed,\n    ariaHaspopup,\n    preferInputActivator = true,\n    colorScheme\n  } = _ref,\n      rest = _objectWithoutProperties(_ref, [\"activatorWrapper\", \"children\", \"onClose\", \"activator\", \"active\", \"fixed\", \"ariaHaspopup\", \"preferInputActivator\", \"colorScheme\"]);\n\n  const [activatorNode, setActivatorNode] = useState();\n  const activatorContainer = useRef(null);\n  const WrapperComponent = activatorWrapper;\n  const id = useUniqueId('popover');\n  const setAccessibilityAttributes = useCallback(() => {\n    if (activatorContainer.current == null) {\n      return;\n    }\n\n    const firstFocusable = findFirstFocusableNodeIncludingDisabled(activatorContainer.current);\n    const focusableActivator = firstFocusable || activatorContainer.current;\n    const activatorDisabled = 'disabled' in focusableActivator && Boolean(focusableActivator.disabled);\n    setActivatorAttributes$1(focusableActivator, {\n      id,\n      active,\n      ariaHaspopup,\n      activatorDisabled\n    });\n  }, [id, active, ariaHaspopup]);\n\n  const handleClose = source => {\n    onClose(source);\n\n    if (activatorContainer.current == null) {\n      return;\n    }\n\n    if ((source === PopoverCloseSource.FocusOut || source === PopoverCloseSource.EscapeKeypress) && activatorNode) {\n      const focusableActivator = findFirstFocusableNodeIncludingDisabled(activatorNode) || findFirstFocusableNodeIncludingDisabled(activatorContainer.current) || activatorContainer.current;\n\n      if (!focusNextFocusableNode(focusableActivator, isInPortal)) {\n        focusableActivator.focus();\n      }\n    }\n  };\n\n  useEffect(() => {\n    if (!activatorNode && activatorContainer.current) {\n      setActivatorNode(activatorContainer.current.firstElementChild);\n    } else if (activatorNode && activatorContainer.current && !activatorContainer.current.contains(activatorNode)) {\n      setActivatorNode(activatorContainer.current.firstElementChild);\n    }\n\n    setAccessibilityAttributes();\n  }, [activatorNode, setAccessibilityAttributes]);\n  useEffect(() => {\n    if (activatorNode && activatorContainer.current) {\n      setActivatorNode(activatorContainer.current.firstElementChild);\n    }\n\n    setAccessibilityAttributes();\n  }, [activatorNode, setAccessibilityAttributes]);\n  const portal = activatorNode ? /*#__PURE__*/React$1.createElement(Portal$1, {\n    idPrefix: \"popover\"\n  }, /*#__PURE__*/React$1.createElement(PopoverOverlay$1, Object.assign({\n    id: id,\n    activator: activatorNode,\n    preferInputActivator: preferInputActivator,\n    onClose: handleClose,\n    active: active,\n    fixed: fixed,\n    colorScheme: colorScheme\n  }, rest), children)) : null;\n  return /*#__PURE__*/React$1.createElement(WrapperComponent, {\n    ref: activatorContainer\n  }, Children.only(activator), portal);\n};\n\nfunction isInPortal(element) {\n  let parentElement = element.parentElement;\n\n  while (parentElement) {\n    if (parentElement.matches(portal.selector)) return false;\n    parentElement = parentElement.parentElement;\n  }\n\n  return true;\n}\n\nPopover.Pane = Pane$1;\nPopover.Section = Section$1;\n\nexport { Popover };\n"]},"metadata":{},"sourceType":"module"}