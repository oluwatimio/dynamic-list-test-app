{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar tslib_1 = require(\"tslib\");\n\nvar react_1 = require(\"react\");\n\nvar utilities_1 = require(\"../../utilities\");\n\nfunction updateAction(value) {\n  return {\n    type: 'update',\n    payload: value\n  };\n}\n\nexports.updateAction = updateAction;\n\nfunction resetAction() {\n  return {\n    type: 'reset'\n  };\n}\n\nexports.resetAction = resetAction;\n\nfunction newDefaultAction(value) {\n  return {\n    type: 'newDefaultValue',\n    payload: value\n  };\n}\n\nexports.newDefaultAction = newDefaultAction;\n\nfunction updateErrorAction(error) {\n  return {\n    type: 'updateError',\n    payload: error\n  };\n}\n\nexports.updateErrorAction = updateErrorAction;\nvar shallowFieldReducer = makeFieldReducer({\n  dirtyStateComparator: utilities_1.defaultDirtyComparator\n});\n\nfunction reduceField(prevState, action) {\n  return shallowFieldReducer(prevState, action);\n}\n\nexports.reduceField = reduceField;\n\nfunction makeFieldReducer(_a) {\n  var _b = _a.dirtyStateComparator,\n      dirtyStateComparator = _b === void 0 ? utilities_1.defaultDirtyComparator : _b;\n  return function (state, action) {\n    switch (action.type) {\n      case 'update':\n        {\n          var newValue = action.payload;\n          var defaultValue = state.defaultValue;\n          var dirty = dirtyStateComparator(defaultValue, newValue);\n          return tslib_1.__assign(tslib_1.__assign({}, state), {\n            dirty: dirty,\n            value: newValue,\n            touched: true\n          });\n        }\n\n      case 'updateError':\n        {\n          var payload = Array.isArray(action.payload) ? action.payload : [action.payload];\n\n          var _a = tslib_1.__read(payload, 1),\n              firstError = _a[0];\n\n          var allErrors = firstError ? payload : [];\n\n          if (utilities_1.shallowArrayComparison(allErrors, state.allErrors)) {\n            return tslib_1.__assign(tslib_1.__assign({}, state), {\n              error: firstError\n            });\n          } else {\n            return tslib_1.__assign(tslib_1.__assign({}, state), {\n              error: firstError,\n              allErrors: allErrors\n            });\n          }\n        }\n\n      case 'reset':\n        {\n          var defaultValue = state.defaultValue;\n          return tslib_1.__assign(tslib_1.__assign({}, state), {\n            error: undefined,\n            value: defaultValue,\n            dirty: false,\n            touched: false,\n            allErrors: []\n          });\n        }\n\n      case 'newDefaultValue':\n        {\n          var newDefaultValue = action.payload;\n          return tslib_1.__assign(tslib_1.__assign({}, state), {\n            error: undefined,\n            value: newDefaultValue,\n            defaultValue: newDefaultValue,\n            touched: false,\n            dirty: false\n          });\n        }\n    }\n  };\n}\n\nexports.makeFieldReducer = makeFieldReducer;\n\nfunction useFieldReducer(value, dirtyStateComparator) {\n  return react_1.useReducer(makeFieldReducer({\n    dirtyStateComparator: dirtyStateComparator\n  }), initialFieldState(value));\n}\n\nexports.useFieldReducer = useFieldReducer;\n\nfunction initialFieldState(value) {\n  return {\n    value: value,\n    defaultValue: value,\n    error: undefined,\n    touched: false,\n    dirty: false,\n    allErrors: []\n  };\n}\n\nexports.initialFieldState = initialFieldState;","map":{"version":3,"sources":["/Users/timi/Desktop/typescript-test/node_modules/@shopify/react-form/dist/src/hooks/field/reducer.js"],"names":["Object","defineProperty","exports","value","tslib_1","require","react_1","utilities_1","updateAction","type","payload","resetAction","newDefaultAction","updateErrorAction","error","shallowFieldReducer","makeFieldReducer","dirtyStateComparator","defaultDirtyComparator","reduceField","prevState","action","_a","_b","state","newValue","defaultValue","dirty","__assign","touched","Array","isArray","__read","firstError","allErrors","shallowArrayComparison","undefined","newDefaultValue","useFieldReducer","useReducer","initialFieldState"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar tslib_1 = require(\"tslib\");\nvar react_1 = require(\"react\");\nvar utilities_1 = require(\"../../utilities\");\nfunction updateAction(value) {\n    return {\n        type: 'update',\n        payload: value,\n    };\n}\nexports.updateAction = updateAction;\nfunction resetAction() {\n    return {\n        type: 'reset',\n    };\n}\nexports.resetAction = resetAction;\nfunction newDefaultAction(value) {\n    return {\n        type: 'newDefaultValue',\n        payload: value,\n    };\n}\nexports.newDefaultAction = newDefaultAction;\nfunction updateErrorAction(error) {\n    return {\n        type: 'updateError',\n        payload: error,\n    };\n}\nexports.updateErrorAction = updateErrorAction;\nvar shallowFieldReducer = makeFieldReducer({\n    dirtyStateComparator: utilities_1.defaultDirtyComparator,\n});\nfunction reduceField(prevState, action) {\n    return shallowFieldReducer(prevState, action);\n}\nexports.reduceField = reduceField;\nfunction makeFieldReducer(_a) {\n    var _b = _a.dirtyStateComparator, dirtyStateComparator = _b === void 0 ? utilities_1.defaultDirtyComparator : _b;\n    return function (state, action) {\n        switch (action.type) {\n            case 'update': {\n                var newValue = action.payload;\n                var defaultValue = state.defaultValue;\n                var dirty = dirtyStateComparator(defaultValue, newValue);\n                return tslib_1.__assign(tslib_1.__assign({}, state), { dirty: dirty, value: newValue, touched: true });\n            }\n            case 'updateError': {\n                var payload = Array.isArray(action.payload)\n                    ? action.payload\n                    : [action.payload];\n                var _a = tslib_1.__read(payload, 1), firstError = _a[0];\n                var allErrors = firstError ? payload : [];\n                if (utilities_1.shallowArrayComparison(allErrors, state.allErrors)) {\n                    return tslib_1.__assign(tslib_1.__assign({}, state), { error: firstError });\n                }\n                else {\n                    return tslib_1.__assign(tslib_1.__assign({}, state), { error: firstError, allErrors: allErrors });\n                }\n            }\n            case 'reset': {\n                var defaultValue = state.defaultValue;\n                return tslib_1.__assign(tslib_1.__assign({}, state), { error: undefined, value: defaultValue, dirty: false, touched: false, allErrors: [] });\n            }\n            case 'newDefaultValue': {\n                var newDefaultValue = action.payload;\n                return tslib_1.__assign(tslib_1.__assign({}, state), { error: undefined, value: newDefaultValue, defaultValue: newDefaultValue, touched: false, dirty: false });\n            }\n        }\n    };\n}\nexports.makeFieldReducer = makeFieldReducer;\nfunction useFieldReducer(value, dirtyStateComparator) {\n    return react_1.useReducer(makeFieldReducer({ dirtyStateComparator: dirtyStateComparator }), initialFieldState(value));\n}\nexports.useFieldReducer = useFieldReducer;\nfunction initialFieldState(value) {\n    return {\n        value: value,\n        defaultValue: value,\n        error: undefined,\n        touched: false,\n        dirty: false,\n        allErrors: [],\n    };\n}\nexports.initialFieldState = initialFieldState;\n"]},"metadata":{},"sourceType":"script"}