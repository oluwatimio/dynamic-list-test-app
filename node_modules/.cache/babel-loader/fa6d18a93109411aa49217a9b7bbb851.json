{"ast":null,"code":"import React$1, { useState, useCallback } from 'react';\nimport { useFeatures } from '../../utilities/features/hooks.js';\nimport { useUniqueId } from '../../utilities/unique-id/hooks.js';\nimport { classNames } from '../../utilities/css.js';\nimport { arraysAreEqual } from '../../utilities/arrays.js';\nimport { useDeepEffect as useDeepEffect$1 } from '../../utilities/use-deep-effect.js';\nimport { Option as Option$1 } from './components/Option/Option.js';\nimport styles from './OptionList.scss.js';\n\nfunction OptionList({\n  options,\n  sections,\n  title,\n  selected,\n  allowMultiple,\n  role,\n  optionRole,\n  onChange,\n  id: idProp\n}) {\n  const [normalizedOptions, setNormalizedOptions] = useState(createNormalizedOptions(options, sections, title));\n  const id = useUniqueId('OptionList', idProp);\n  const {\n    newDesignLanguage\n  } = useFeatures();\n  useDeepEffect$1(() => {\n    setNormalizedOptions(createNormalizedOptions(options || [], sections || [], title));\n  }, [options, sections, title], optionArraysAreEqual);\n  const handleClick = useCallback((sectionIndex, optionIndex) => {\n    const selectedValue = normalizedOptions[sectionIndex].options[optionIndex].value;\n    const foundIndex = selected.indexOf(selectedValue);\n\n    if (allowMultiple) {\n      const newSelection = foundIndex === -1 ? [selectedValue, ...selected] : [...selected.slice(0, foundIndex), ...selected.slice(foundIndex + 1, selected.length)];\n      onChange(newSelection);\n      return;\n    }\n\n    onChange([selectedValue]);\n  }, [normalizedOptions, selected, allowMultiple, onChange]);\n  const optionsExist = normalizedOptions.length > 0;\n  const optionsMarkup = optionsExist ? normalizedOptions.map(({\n    title,\n    options\n  }, sectionIndex) => {\n    const titleMarkup = title ? /*#__PURE__*/React$1.createElement(\"p\", {\n      className: styles.Title,\n      role: role\n    }, title) : null;\n    const optionsMarkup = options && options.map((option, optionIndex) => {\n      const isSelected = selected.includes(option.value);\n      const optionId = option.id || `${id}-${sectionIndex}-${optionIndex}`;\n      return /*#__PURE__*/React$1.createElement(Option$1, Object.assign({}, option, {\n        key: optionId,\n        id: optionId,\n        section: sectionIndex,\n        index: optionIndex,\n        onClick: handleClick,\n        select: isSelected,\n        allowMultiple: allowMultiple,\n        role: optionRole\n      }));\n    });\n    return /*#__PURE__*/React$1.createElement(\"li\", {\n      key: title || `noTitle-${sectionIndex}`\n    }, titleMarkup, /*#__PURE__*/React$1.createElement(\"ul\", {\n      className: styles.Options,\n      id: `${id}-${sectionIndex}`,\n      role: role,\n      \"aria-multiselectable\": allowMultiple\n    }, optionsMarkup));\n  }) : null;\n  const optionListClassName = classNames(styles.OptionList, newDesignLanguage && styles.newDesignLanguage);\n  return /*#__PURE__*/React$1.createElement(\"ul\", {\n    className: optionListClassName,\n    role: role\n  }, optionsMarkup);\n}\n\nfunction createNormalizedOptions(options, sections, title) {\n  if (options == null) {\n    const section = {\n      options: [],\n      title\n    };\n    return sections == null ? [] : [section, ...sections];\n  }\n\n  if (sections == null) {\n    return [{\n      title,\n      options\n    }];\n  }\n\n  return [{\n    title,\n    options\n  }, ...sections];\n}\n\nfunction isSection(arr) {\n  return typeof arr[0] === 'object' && Object.prototype.hasOwnProperty.call(arr[0], 'options');\n}\n\nfunction optionArraysAreEqual(firstArray, secondArray) {\n  if (isSection(firstArray) && isSection(secondArray)) {\n    return arraysAreEqual(firstArray, secondArray, testSectionsPropEquality);\n  }\n\n  return arraysAreEqual(firstArray, secondArray);\n}\n\nfunction testSectionsPropEquality(previousSection, currentSection) {\n  const {\n    options: previousOptions\n  } = previousSection;\n  const {\n    options: currentOptions\n  } = currentSection;\n  const optionsAreEqual = arraysAreEqual(previousOptions, currentOptions);\n  const titlesAreEqual = previousSection.title === currentSection.title;\n  return optionsAreEqual && titlesAreEqual;\n}\n\nexport { OptionList };","map":{"version":3,"sources":["/Users/timi/Desktop/typescript-test/node_modules/@shopify/polaris/dist/esm/components/OptionList/OptionList.js"],"names":["React$1","useState","useCallback","useFeatures","useUniqueId","classNames","arraysAreEqual","useDeepEffect","useDeepEffect$1","Option","Option$1","styles","OptionList","options","sections","title","selected","allowMultiple","role","optionRole","onChange","id","idProp","normalizedOptions","setNormalizedOptions","createNormalizedOptions","newDesignLanguage","optionArraysAreEqual","handleClick","sectionIndex","optionIndex","selectedValue","value","foundIndex","indexOf","newSelection","slice","length","optionsExist","optionsMarkup","map","titleMarkup","createElement","className","Title","option","isSelected","includes","optionId","Object","assign","key","section","index","onClick","select","Options","optionListClassName","isSection","arr","prototype","hasOwnProperty","call","firstArray","secondArray","testSectionsPropEquality","previousSection","currentSection","previousOptions","currentOptions","optionsAreEqual","titlesAreEqual"],"mappings":"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","sourcesContent":["import React$1, { useState, useCallback } from 'react';\nimport { useFeatures } from '../../utilities/features/hooks.js';\nimport { useUniqueId } from '../../utilities/unique-id/hooks.js';\nimport { classNames } from '../../utilities/css.js';\nimport { arraysAreEqual } from '../../utilities/arrays.js';\nimport { useDeepEffect as useDeepEffect$1 } from '../../utilities/use-deep-effect.js';\nimport { Option as Option$1 } from './components/Option/Option.js';\nimport styles from './OptionList.scss.js';\n\nfunction OptionList({\n  options,\n  sections,\n  title,\n  selected,\n  allowMultiple,\n  role,\n  optionRole,\n  onChange,\n  id: idProp\n}) {\n  const [normalizedOptions, setNormalizedOptions] = useState(createNormalizedOptions(options, sections, title));\n  const id = useUniqueId('OptionList', idProp);\n  const {\n    newDesignLanguage\n  } = useFeatures();\n  useDeepEffect$1(() => {\n    setNormalizedOptions(createNormalizedOptions(options || [], sections || [], title));\n  }, [options, sections, title], optionArraysAreEqual);\n  const handleClick = useCallback((sectionIndex, optionIndex) => {\n    const selectedValue = normalizedOptions[sectionIndex].options[optionIndex].value;\n    const foundIndex = selected.indexOf(selectedValue);\n\n    if (allowMultiple) {\n      const newSelection = foundIndex === -1 ? [selectedValue, ...selected] : [...selected.slice(0, foundIndex), ...selected.slice(foundIndex + 1, selected.length)];\n      onChange(newSelection);\n      return;\n    }\n\n    onChange([selectedValue]);\n  }, [normalizedOptions, selected, allowMultiple, onChange]);\n  const optionsExist = normalizedOptions.length > 0;\n  const optionsMarkup = optionsExist ? normalizedOptions.map(({\n    title,\n    options\n  }, sectionIndex) => {\n    const titleMarkup = title ? /*#__PURE__*/React$1.createElement(\"p\", {\n      className: styles.Title,\n      role: role\n    }, title) : null;\n    const optionsMarkup = options && options.map((option, optionIndex) => {\n      const isSelected = selected.includes(option.value);\n      const optionId = option.id || `${id}-${sectionIndex}-${optionIndex}`;\n      return /*#__PURE__*/React$1.createElement(Option$1, Object.assign({}, option, {\n        key: optionId,\n        id: optionId,\n        section: sectionIndex,\n        index: optionIndex,\n        onClick: handleClick,\n        select: isSelected,\n        allowMultiple: allowMultiple,\n        role: optionRole\n      }));\n    });\n    return /*#__PURE__*/React$1.createElement(\"li\", {\n      key: title || `noTitle-${sectionIndex}`\n    }, titleMarkup, /*#__PURE__*/React$1.createElement(\"ul\", {\n      className: styles.Options,\n      id: `${id}-${sectionIndex}`,\n      role: role,\n      \"aria-multiselectable\": allowMultiple\n    }, optionsMarkup));\n  }) : null;\n  const optionListClassName = classNames(styles.OptionList, newDesignLanguage && styles.newDesignLanguage);\n  return /*#__PURE__*/React$1.createElement(\"ul\", {\n    className: optionListClassName,\n    role: role\n  }, optionsMarkup);\n}\n\nfunction createNormalizedOptions(options, sections, title) {\n  if (options == null) {\n    const section = {\n      options: [],\n      title\n    };\n    return sections == null ? [] : [section, ...sections];\n  }\n\n  if (sections == null) {\n    return [{\n      title,\n      options\n    }];\n  }\n\n  return [{\n    title,\n    options\n  }, ...sections];\n}\n\nfunction isSection(arr) {\n  return typeof arr[0] === 'object' && Object.prototype.hasOwnProperty.call(arr[0], 'options');\n}\n\nfunction optionArraysAreEqual(firstArray, secondArray) {\n  if (isSection(firstArray) && isSection(secondArray)) {\n    return arraysAreEqual(firstArray, secondArray, testSectionsPropEquality);\n  }\n\n  return arraysAreEqual(firstArray, secondArray);\n}\n\nfunction testSectionsPropEquality(previousSection, currentSection) {\n  const {\n    options: previousOptions\n  } = previousSection;\n  const {\n    options: currentOptions\n  } = currentSection;\n  const optionsAreEqual = arraysAreEqual(previousOptions, currentOptions);\n  const titlesAreEqual = previousSection.title === currentSection.title;\n  return optionsAreEqual && titlesAreEqual;\n}\n\nexport { OptionList };\n"]},"metadata":{},"sourceType":"module"}